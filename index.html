<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>The Bandits</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description"
      content="Find Your Trail Friends! The Bandits are a Trail Running Community based in the SF Bay Area. Join us for group runs, social events, and more.">

    <script id="prefetch-data" type="module">
      // Only prefetch on home page
      if (window.location.pathname === '/') {
        // Get preferred first day of week from localStorage (default to Monday)
        const pref = localStorage.getItem('preferred-first-day-of-week');
        const firstDayNum = pref ? parseInt(pref, 10) : 1;
        const day = firstDayNum === 0 ? 'sunday' : 'monday';

        // Week number calculation matching app/utils/helpers.ts getWeekNumber
        function getWeekNumber(date, dayType) {
          const d = new Date(date);
          d.setHours(0, 0, 0, 0);

          const year = d.getFullYear();
          const jan1 = new Date(year, 0, 1);
          const jan1Day = jan1.getDay(); // 0 = Sunday, 1 = Monday

          // Days since Jan 1 (0-indexed)
          const dayOfYear = Math.floor((d.getTime() - jan1.getTime()) / 86400000);

          const firstDayNum = dayType === 'monday' ? 1 : 0;

          if (jan1Day === firstDayNum) {
            return Math.floor(dayOfYear / 7) + 1;
          }

          const daysUntilFirstStartDay = firstDayNum === 0
            ? (jan1Day === 0 ? 0 : 7 - jan1Day)
            : (jan1Day === 1 ? 0 : 8 - jan1Day);

          if (dayOfYear < daysUntilFirstStartDay) {
            return 1;
          }

          return Math.floor((dayOfYear - daysUntilFirstStartDay) / 7) + 2;
        }

        // Get current week
        const today = new Date();
        const currentYear = today.getFullYear();
        const currentWeek = getWeekNumber(today, day);

        // Build URLs
        const url = '/api/weeks/' + currentYear + '-' + String(currentWeek).padStart(2, '0') + '-' + day + '.json';
        fetch(url, { url, method: 'GET', priority: 'high', credentials: 'include', mode: 'cors' });
      }
    </script>

    <!-- Preload critical Montserrat font files (latin only) - These are the 2 woff2 files mentioned -->
    <link rel="preload" as="font" type="font/woff2" href="/fonts/montserrat-regular.woff2" crossorigin>
    <link rel="preload" as="font" type="font/woff2" href="/fonts/montserrat-bold.woff2" crossorigin>

    <!-- Preload critical SVG assets -->
    <link rel="preload" as="image" href="/logo-orange-chevron.svg" crossorigin>
    <link rel="preload" as="image" href="/redwood.svg" crossorigin>
    <link rel="preload" as="image" href="/nps.svg" crossorigin>

    <link rel="stylesheet" href="/app/styles/app.css">
    <link rel="icon" href="/favicon.ico" sizes="32x32">
    <link rel="icon" href="/images/light/logo-chevron-inverted.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/images/light/apple-touch-icon-180x180-chevron-inverted.png" type="image/png">
    <meta name="keywords" content="trail running community SF Bay Area group runs social events">
    <meta name="apple-mobile-web-app-title" content="The Bandits">
    <meta itemprop="description"
      content="Find Your Trail Friends! The Bandits are a Trail Running Community based in the SF Bay Area. Join us for group runs, social events, and more.">
    <meta property="og:title" content="The Bandits">
    <meta property="og:site_name" content="bandits.run">
    <meta property="og:type" content="website">
    <meta property="og:description"
      content="Find Your Trail Friends! The Bandits are a Trail Running Community based in the SF Bay Area. Join us for group runs, social events, and more.">
    <meta property="og:url" content="https://bandits.run">
    <meta property="og:image" content="/images/light/og-banner-1200x630.png">

    <script id="check-mac-os">
      document.documentElement.classList.toggle("mac", /Mac|iPhone|iPod|iPad/i.test(navigator.platform));
    </script>
    </head>
  <body>
    <script type="module">
      import Application from './app/app';
      import environment from './app/config/environment';

      Application.create(environment.APP);
</script>
</body>
</html>
